<!doctype html><html lang=en><head><meta charset=utf-8><title>Greg Barbieri</title><link href=https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css rel=stylesheet><link href=/css/custom.css rel=stylesheet><link href=/css/syntax.css rel=stylesheet><script src=https://kit.fontawesome.com/d86cd22b71.js crossorigin=anonymous></script>
<link href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css rel=stylesheet><script src=https://code.jquery.com/jquery-3.2.1.slim.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js></script>
<script src=https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js></script>
<script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body><nav class="navbar navbar-expand-sm fixed-top"><div class=container><a class=navbar-brand href=/>Greg Barbieri</a><div class="collapse navbar-collapse"><ul class="nav navbar-nav mr-auto"></ul><ul class=navbar-nav><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown>Code Tutorials</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdown><a class=dropdown-item href=/code_topics/code_topics#fun>Fun Problems</a></div></li></ul></div></div></nav><main class=code_tutorial><div class=container style=padding-top:100px><div class=row><div class=col-sm-12><article><header><h1>Removing Repetitions</h1></header><div class=content><p>This question comes from Professor David Morin&rsquo;s book, <a href=http://www.people.fas.harvard.edu/~djmorin/book.html>Probability For the Enthusiastic Beginner</a>, Chapter 1, page 26.</p><ol><li>We know that the number of ordered sets of three people chosen from five people is $5 \times 4 \times 3 = 60$. Reproduce this results by starting with the naive answer of $5^3 = 125$ ordered sets where repetitions are allowed, and then subtracting off the number of triplets that have repeated people.</li></ol><p>The naive answer comes from the formula $N^{k}$, where we want to select $k$ people from $N$ people, hence $5^3 = 125$. The answer without repetitions comes from the following formula: $$\frac{N!}{(N-k)!} = \frac{5!}{(5-3)!} = \frac{5!}{2!} = 5 \times 4 \times 3 = 60$$</p><p>Using Python, we will count, search for, and remove the repetitions!</p><p>Let&rsquo;s import the required libraries and create a list called <b>people</b> with five elements, each distinctly representing one of the five people.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#007020;font-weight:700>import</span> <span style=color:#0e84b5;font-weight:700>itertools</span>
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>import</span> <span style=color:#0e84b5;font-weight:700>pandas</span> <span style=color:#007020;font-weight:700>as</span> <span style=color:#0e84b5;font-weight:700>pd</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>people <span style=color:#666>=</span> [<span style=color:#4070a0>&#39;P1&#39;</span>, <span style=color:#4070a0>&#39;P2&#39;</span>, <span style=color:#4070a0>&#39;P3&#39;</span>, <span style=color:#4070a0>&#39;P4&#39;</span>, <span style=color:#4070a0>&#39;P5&#39;</span>]
</span></span></code></pre></div><p>To get the naive answer of $5^3 = 125$ ordered sets of three people, we will use the <b>product()</b> function from the itertools library. We will store them in the list called <b>perm_w_rep</b>.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>perm_w_rep <span style=color:#666>=</span> <span style=color:#007020>list</span>(itertools<span style=color:#666>.</span>product(people, repeat<span style=color:#666>=</span><span style=color:#40a070>3</span>))
</span></span><span style=display:flex><span><span style=color:#007020>len</span>(perm_w_rep)
</span></span></code></pre></div><pre><code>125
</code></pre><p>If an arrangement contains a person (P1 - P5) more than once, then that arrangement is said to have a repetition. Before we search for and remove arrangements with repetitions, let&rsquo;s write out a few examples.</p><p>The first type of arrangement with repetitions is when the same person is selected to fill all three spots. This can only occur one way for each person. Since there are five people, there are five arrangements with repetitions of this type of in our list <b>perm_w_rep</b>. All five are written out below.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#007020>print</span>(perm_w_rep[<span style=color:#40a070>0</span>], perm_w_rep[<span style=color:#40a070>31</span>], perm_w_rep[<span style=color:#40a070>62</span>], perm_w_rep[<span style=color:#40a070>93</span>], perm_w_rep[<span style=color:#40a070>124</span>])
</span></span></code></pre></div><pre><code>('P1', 'P1', 'P1') ('P2', 'P2', 'P2') ('P3', 'P3', 'P3') ('P4', 'P4', 'P4') ('P5', 'P5', 'P5')
</code></pre><p>The second type of arrangement with repetitions is when one person is selected twice, with a different person selected only once to fill the remaining spot. This type of arrangement can arise in three different ways for any two people. Below are the three different ways P1 can be selected twice and P2 selected once.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#007020>print</span>(perm_w_rep[<span style=color:#40a070>1</span>], perm_w_rep[<span style=color:#40a070>5</span>], perm_w_rep[<span style=color:#40a070>25</span>])
</span></span></code></pre></div><pre><code>('P1', 'P1', 'P2') ('P1', 'P2', 'P1') ('P2', 'P1', 'P1')
</code></pre><p>My first instinct to search the list <b>perm_w_rep</b> for arrangements with repetitions is to throw all the arrangements in a Pandas DataFrame. Each arrangement would be a row and each position in the arrangement would be the column value.</p><p>Create the DataFrame <b>df_perm_w_rep</b>, naming the columns after the position of the person in the arrangement.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df_perm_w_rep <span style=color:#666>=</span> pd<span style=color:#666>.</span>DataFrame(perm_w_rep, columns <span style=color:#666>=</span> [<span style=color:#4070a0>&#39;First&#39;</span>, <span style=color:#4070a0>&#39;Second&#39;</span>, <span style=color:#4070a0>&#39;Third&#39;</span>])
</span></span><span style=display:flex><span>df_perm_w_rep<span style=color:#666>.</span>head()
</span></span></code></pre></div><div><style>.dataframe thead tr:only-child th{text-align:right}<pre><code>.dataframe thead th{text-align:left}.dataframe tbody tr th{vertical-align:top}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>First</th><th>Second</th><th>Third</th></tr></thead><tbody><tr><th>0</th><td>P1</td><td>P1</td><td>P1</td></tr><tr><th>1</th><td>P1</td><td>P1</td><td>P2</td></tr><tr><th>2</th><td>P1</td><td>P1</td><td>P3</td></tr><tr><th>3</th><td>P1</td><td>P1</td><td>P4</td></tr><tr><th>4</th><td>P1</td><td>P1</td><td>P5</td></tr></tbody></table></div><p>If the value of First equals the value of Second, on the same row, then that arrangement has repetitions. The same logic applies if the value of Second equals the value of Third or the value for First equals Third.</p><p>We will use this logic to set a variable called <b>Repetitions</b> to either True or False. If any of the three positions (three columns) in the arrangement are equal, then that arrangement has a repeated person, setting the variable <b>Repetitions</b> to True.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df_perm_w_rep[<span style=color:#4070a0>&#39;Repetitions&#39;</span>] <span style=color:#666>=</span> ((df_perm_w_rep[<span style=color:#4070a0>&#39;First&#39;</span>] <span style=color:#666>==</span> df_perm_w_rep[<span style=color:#4070a0>&#39;Second&#39;</span>]) <span style=color:#666>|</span> 
</span></span><span style=display:flex><span>                                (df_perm_w_rep[<span style=color:#4070a0>&#39;First&#39;</span>] <span style=color:#666>==</span> df_perm_w_rep[<span style=color:#4070a0>&#39;Third&#39;</span>]) <span style=color:#666>|</span> 
</span></span><span style=display:flex><span>                                (df_perm_w_rep[<span style=color:#4070a0>&#39;Second&#39;</span>] <span style=color:#666>==</span> df_perm_w_rep[<span style=color:#4070a0>&#39;Third&#39;</span>]))
</span></span><span style=display:flex><span>df_perm_w_rep<span style=color:#666>.</span>head()
</span></span></code></pre></div><div><style>.dataframe thead tr:only-child th{text-align:right}<pre><code>.dataframe thead th{text-align:left}.dataframe tbody tr th{vertical-align:top}</code></pre><p></style></p><table border=1 class=dataframe><thead><tr style=text-align:right><th></th><th>First</th><th>Second</th><th>Third</th><th>Repetitions</th></tr></thead><tbody><tr><th>0</th><td>P1</td><td>P1</td><td>P1</td><td>True</td></tr><tr><th>1</th><td>P1</td><td>P1</td><td>P2</td><td>True</td></tr><tr><th>2</th><td>P1</td><td>P1</td><td>P3</td><td>True</td></tr><tr><th>3</th><td>P1</td><td>P1</td><td>P4</td><td>True</td></tr><tr><th>4</th><td>P1</td><td>P1</td><td>P5</td><td>True</td></tr></tbody></table></div><p>Counting the values of the variable <b>Repetitions</b> (either True or False) will tell us exactly how many arrangements have a repeated person. The results show that there are 65 arrangements with repetitions and 60 without.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df_perm_w_rep[<span style=color:#4070a0>&#39;Repetitions&#39;</span>]<span style=color:#666>.</span>value_counts()
</span></span></code></pre></div><pre><code>True     65
False    60
Name: Repetitions, dtype: int64
</code></pre><p>To remove the repetitions, we can create a new DataFrame <b>df_perm_wo_rep</b> with only rows where the variable <b>Repetitions</b> is equal to False. We then clean up the DataFrame by dropping the variable <b>Repetitions</b>.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df_perm_wo_rep <span style=color:#666>=</span> df_perm_w_rep[df_perm_w_rep[<span style=color:#4070a0>&#39;Repetitions&#39;</span>] <span style=color:#666>==</span> <span style=color:#007020;font-weight:700>False</span>]<span style=color:#666>.</span>drop(<span style=color:#4070a0>&#39;Repetitions&#39;</span>, axis<span style=color:#666>=</span><span style=color:#40a070>1</span>)
</span></span></code></pre></div><p>A count of the number of rows in our new DataFrame <b>df_perm_wo_rep</b> shows we have 60 arrangements remaining. This is what we would expect from the formula without repetitions.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#007020>len</span>(df_perm_wo_rep)
</span></span></code></pre></div><pre><code>60
</code></pre><p>Personally, I don&rsquo;t feel complete unless we leave our list in the way that we found it. Let&rsquo;s convert the DataFrame back to a list of tuples.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>perm_wo_rep <span style=color:#666>=</span> []
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>for</span> element <span style=color:#007020;font-weight:700>in</span> df_perm_wo_rep<span style=color:#666>.</span>to_records(index<span style=color:#666>=</span><span style=color:#007020;font-weight:700>False</span>):
</span></span><span style=display:flex><span>    perm_wo_rep<span style=color:#666>.</span>append(<span style=color:#007020>tuple</span>(element))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#007020>len</span>(perm_wo_rep)
</span></span></code></pre></div><pre><code>60
</code></pre></div></article></div></div></div></main><footer class=footer><div class=container><span class=text-muted><p>Greg Barbieri &#183; 2022 &#183; <a href>License</a></p></span><div class="col-md-4 col-sm-6"></div></div></footer></body></html>