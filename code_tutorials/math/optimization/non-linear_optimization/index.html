<!doctype html><html lang=en><head><meta charset=utf-8><title>Greg Barbieri</title><link href=https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css rel=stylesheet><link href=/css/custom.css rel=stylesheet><link href=/css/syntax.css rel=stylesheet><script src=https://kit.fontawesome.com/d86cd22b71.js crossorigin=anonymous></script>
<link href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css rel=stylesheet><script src=https://code.jquery.com/jquery-3.2.1.slim.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js></script>
<script src=https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js></script>
<script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body><nav class="navbar navbar-expand-sm fixed-top"><div class=container><a class=navbar-brand href=/>Greg Barbieri</a><div class="collapse navbar-collapse"><ul class="nav navbar-nav mr-auto"></ul><ul class=navbar-nav><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown>Code Tutorials</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdown><a class=dropdown-item href=/code_topics/code_topics#math>Math</a>
<a class=dropdown-item href=/code_topics/code_topics#gis>GIS</a>
<a class=dropdown-item href=/code_topics/code_topics#data_sources>Data Sources</a></div></li></ul></div></div></nav><main class=code_tutorial><div class=container style=padding-top:100px><div class=row><div class=col-sm-12><article><header><h1>Non-Linear Optimization with Scipy</h1></header><div class=content><p>Optimize a Non-linear Function</p><h3 id=imports>Imports</h3><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#007020;font-weight:700>from</span> <span style=color:#0e84b5;font-weight:700>scipy.optimize</span> <span style=color:#007020;font-weight:700>import</span> minimize
</span></span></code></pre></div><h3 id=define-the-problem>Define the Problem</h3><p>Maximize the utility function $U(x) = 2 x_1 x_2$ subject to the budget constraint $8 x_1+ 4 x_2 = 40$.</p><h3 id=define-the-objective-function>Define the Objective Function</h3><p>Create a Python function called <code>f</code> that takes in a vector called <code>x</code>, so <code>f(x)</code>. The vector <code>x</code> can be expected to have two elements, one for each subscript in the objective function. The Python function <code>f(x)</code> should return a value equal to the objective function.</p><p><strong>Note:</strong> The <code>minimize</code> function <em>minimizes</em> the objective, but we want to <em>maximize</em> the objective. In order to maximize, multiply the objective function by -1.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>f</span>(x):
</span></span><span style=display:flex><span>    <span style=color:#007020;font-weight:700>return</span> <span style=color:#666>-</span><span style=color:#40a070>1</span> <span style=color:#666>*</span> (<span style=color:#40a070>2</span> <span style=color:#666>*</span> x[<span style=color:#40a070>0</span>] <span style=color:#666>*</span> x[<span style=color:#40a070>1</span>])
</span></span></code></pre></div><h3 id=define-the-constraint>Define the Constraint</h3><p>Create a Python function called <code>constraints</code> that takes <code>x</code> as an argument and returns a value equal to the constraint function. If you have multiple constraints, you may be able to return the results of multiple functions without affecting the results. However, I recommend creating another constraint function.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#007020;font-weight:700>def</span> <span style=color:#06287e>constraint</span>(x):
</span></span><span style=display:flex><span>    <span style=color:#007020;font-weight:700>return</span> x[<span style=color:#40a070>0</span>]<span style=color:#666>*</span><span style=color:#40a070>8</span> <span style=color:#666>+</span> x[<span style=color:#40a070>1</span>]<span style=color:#666>*</span><span style=color:#40a070>4</span> <span style=color:#666>-</span> <span style=color:#40a070>40</span>
</span></span></code></pre></div><h3 id=maximize-the-objective-function>Maximize the Objective Function</h3><p>Create the constraint dictionary <code>con</code> that contains details about each constraint function. The constraints here are equalities, so <code>type</code> is <code>eq</code>. The <code>fun</code> is short for &ldquo;functions&rdquo; and we set it equal to our constraint function. If you have multiple constraints, then create a list called <code>con</code> where each element is the constraint dictionary for each constraint function.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>con <span style=color:#666>=</span> {<span style=color:#4070a0>&#39;type&#39;</span>: <span style=color:#4070a0>&#39;eq&#39;</span>, <span style=color:#4070a0>&#39;fun&#39;</span>: constraint}
</span></span></code></pre></div><p>Define the starting point or initial guess to begin numerical algorithm. Length must be equal to the number of independent variables, in this case two. Use either all zero&rsquo;s or all one&rsquo;s, but there exists a literature on pre-searching techniques.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>x0 <span style=color:#666>=</span> [<span style=color:#40a070>1</span>, <span style=color:#40a070>1</span>]
</span></span></code></pre></div><p>Optimize the objective function given constraints.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>res <span style=color:#666>=</span> minimize(f, x0<span style=color:#666>=</span>x0, constraints<span style=color:#666>=</span>con)
</span></span></code></pre></div><p>Optimal values of $x_1$ and $x_2$ are stored as an array in the key <code>x</code>. They should equal $x_1 = 2.5$, $x_2 = 5$. The utility of $U(2.5, 5) = 25$, stored in the key <code>fun</code> as a negative number because of our transformation to a maximization problem.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>res
</span></span></code></pre></div><pre><code>     fun: -25.000000000000004
     jac: array([-10.,  -5.])
 message: 'Optimization terminated successfully'
    nfev: 12
     nit: 4
    njev: 4
  status: 0
 success: True
       x: array([2.49999999, 5.00000001])
</code></pre></div></article></div></div></div></main><footer class=footer><div class=container><span class=text-muted><p>Greg Barbieri &#183; 2022 &#183; <a href>License</a></p></span><div class="col-md-4 col-sm-6"></div></div></footer></body></html>