<!doctype html><html lang=en><head><meta charset=utf-8><title>Greg Barbieri</title><link href=https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css rel=stylesheet><link href=/css/custom.css rel=stylesheet><link href=/css/syntax.css rel=stylesheet><script src=https://kit.fontawesome.com/d86cd22b71.js crossorigin=anonymous></script>
<link href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css rel=stylesheet><script src=https://code.jquery.com/jquery-3.2.1.slim.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js></script>
<script src=https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js></script>
<script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body><nav class="navbar navbar-expand-sm fixed-top"><div class=container><a class=navbar-brand href=/>Greg Barbieri</a><div class="collapse navbar-collapse"><ul class="nav navbar-nav mr-auto"></ul><ul class=navbar-nav><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown>Code Tutorials</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdown><a class=dropdown-item href=/code_topics/code_topics#math>Math</a>
<a class=dropdown-item href=/code_topics/code_topics#gis>GIS</a>
<a class=dropdown-item href=/code_topics/code_topics#data_sources>Data Sources</a></div></li></ul></div></div></nav><main class=code_tutorial><div class=container style=padding-top:100px><div class=row><div class=col-sm-12><article><header><h1>Write Data to a SAS Dataset</h1></header><div class=content><p>Write Pandas Data Frame to SAS dataset. Requires a SAS installation. <a href=https://sassoftware.github.io/saspy/>SASPy documentation</a></p><h3 id=imports>Imports</h3><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#007020;font-weight:700>import</span> <span style=color:#0e84b5;font-weight:700>os</span>
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>import</span> <span style=color:#0e84b5;font-weight:700>saspy</span>
</span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>import</span> <span style=color:#0e84b5;font-weight:700>pandas</span> <span style=color:#007020;font-weight:700>as</span> <span style=color:#0e84b5;font-weight:700>pd</span>
</span></span></code></pre></div><h3 id=set-path-environment-variable>Set PATH Environment Variable</h3><p>Add the location of the sspiauth.dll file to the PATH environment variables. For those who are unable to edit environmental variables without administrative permissions, execute the following code at run time with the correct file location.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>os<span style=color:#666>.</span>environ[<span style=color:#4070a0>&#34;PATH&#34;</span>] <span style=color:#666>+=</span> os<span style=color:#666>.</span>environ[<span style=color:#4070a0>&#34;PATH&#34;</span>][:<span style=color:#666>-</span><span style=color:#40a070>1</span>] <span style=color:#666>+</span> <span style=color:#4070a0>&#39;C:</span><span style=color:#4070a0;font-weight:700>\\</span><span style=color:#4070a0>SASHome</span><span style=color:#4070a0;font-weight:700>\\</span><span style=color:#4070a0>SASFoundation</span><span style=color:#4070a0;font-weight:700>\\</span><span style=color:#4070a0>9.4</span><span style=color:#4070a0;font-weight:700>\\</span><span style=color:#4070a0>core</span><span style=color:#4070a0;font-weight:700>\\</span><span style=color:#4070a0>sasext;&#39;</span>
</span></span></code></pre></div><h3 id=create-pandas-data-frame>Create Pandas Data Frame</h3><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>df <span style=color:#666>=</span> pd<span style=color:#666>.</span>DataFrame(data<span style=color:#666>=</span>[[<span style=color:#4070a0>&#39;apple&#39;</span>, <span style=color:#4070a0>&#39;iris&#39;</span>, <span style=color:#4070a0>&#39;oak&#39;</span>],
</span></span><span style=display:flex><span>                        [<span style=color:#4070a0>&#39;grape&#39;</span>, <span style=color:#4070a0>&#39;juniper&#39;</span>, <span style=color:#4070a0>&#39;ash&#39;</span>],
</span></span><span style=display:flex><span>                        [<span style=color:#4070a0>&#39;strawberry&#39;</span>, <span style=color:#4070a0>&#39;chamomile &#39;</span>, <span style=color:#4070a0>&#39;pine&#39;</span>]],
</span></span><span style=display:flex><span>                  columns<span style=color:#666>=</span>[<span style=color:#4070a0>&#39;fruit&#39;</span>,<span style=color:#4070a0>&#39;flower&#39;</span>,<span style=color:#4070a0>&#39;tree&#39;</span>])
</span></span></code></pre></div><h3 id=start-sas-session>Start SAS Session</h3><p>To start a SAS session, you may need to create and point to a personalized SAS configuration file. Instructions are <a href=https://sassoftware.github.io/saspy/install.html#configuration>here</a>. Most of the options in the template configuration file do not need to be edited. Just point to the correct SAS installation and use the correct configuration name.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>sas <span style=color:#666>=</span> saspy<span style=color:#666>.</span>SASsession(cfgfile<span style=color:#666>=</span><span style=color:#4070a0>&#39;sascfg_personal.py&#39;</span>)
</span></span></code></pre></div><pre><code>Using SAS Config named: winlocal
SAS Connection established. Subprocess id is 18352
</code></pre><h3 id=create-library-reference>Create Library Reference</h3><p>SAS library reference uses the root directory by default. For Windows, that&rsquo;s likely the &ldquo;C:\&rdquo; drive. Update path to your desired location.</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>sas<span style=color:#666>.</span>saslib(<span style=color:#4070a0>&#39;libout&#39;</span>, path<span style=color:#666>=</span><span style=color:#4070a0>&#34;</span><span style=color:#4070a0;font-weight:700>\\</span><span style=color:#4070a0>&#34;</span>)
</span></span></code></pre></div><pre><code>19                                                         The SAS System                            09:39 Wednesday, March 23, 2022

113        
114        libname libout    '\'  ;
NOTE: Libref LIBOUT was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: C:\
115        
116        
117        

20                                                         The SAS System                            09:39 Wednesday, March 23, 2022

118        
</code></pre><h3 id=write-to-sas-dataset>Write to SAS Dataset</h3><p><code>df</code> is the Pandas Data Frame. <code>table</code> is the name of the output SAS dataset. <code>libref</code> is the output library reference. Equivalent to:</p><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sas data-lang=sas><span style=display:flex><span><span style=color:#007020;font-weight:700>data </span>libout<span style=color:#40a070>.</span>output_dataset;
</span></span><span style=display:flex><span>    <span style=color:#007020;font-weight:700>set</span> work<span style=color:#40a070>.</span>df<span style=color:#007020;font-weight:700>;
</span></span></span><span style=display:flex><span><span style=color:#007020;font-weight:700>run;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>sas<span style=color:#666>.</span>dataframe2sasdata(df<span style=color:#666>=</span>df, table<span style=color:#666>=</span><span style=color:#4070a0>&#34;output_dataset&#34;</span>, libref<span style=color:#666>=</span><span style=color:#4070a0>&#39;libout&#39;</span>)
</span></span></code></pre></div><pre><code>Libref  = libout
Table   = output_dataset
Dsopts  = {}
Results = Pandas
</code></pre><h3 id=end-sas-session>End SAS Session</h3><div class=highlight><pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>sas<span style=color:#666>.</span>endsas()
</span></span></code></pre></div><pre><code>SAS Connection terminated. Subprocess id was 18352
</code></pre></div></article></div></div></div></main><footer class=footer><div class=container><span class=text-muted><p>Greg Barbieri &#183; 2022 &#183; <a href>License</a></p></span><div class="col-md-4 col-sm-6"></div></div></footer></body></html>